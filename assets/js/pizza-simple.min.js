!function($){const dataComponents=JSON.parse($(".pizza_components_wrapper").attr("data-pizza"));let initialPrice=$(".pizza_components_wrapper").attr("data-price");const inputBase=$("input[name=u-pizza-base]");if(0===$("form.variations_form").length&&$("form.cart").length>0){$(".component-buttons").on("click",".plus, .minus",(function(){calculate()})),$("#remove-component .pizza-components-item").on("click",(function(){calculateComponentsRemove($(this))})),$("#pizza-floor-button").on("click",(function(e){e.preventDefault(),$.fancybox.open({src:"#u-pizza-floors-fancybox",type:"inline",touch:!1,opts:{afterShow:function(instance,current){let floorFancy=$(document.body).find("#u-pizza-floors-fancybox");window.matchMedia("(min-width: 768px)").matches?floorFancy.height()>window.innerHeight-100&&(floorFancy.css("border-width","0"),$(".pizza-floors-block",floorFancy).slimScroll({height:window.innerHeight-100,railVisible:!0,alwaysVisible:!0,size:"6px",color:"#FF0329",railColor:"#EAEAEA",railOpacity:1,wheelStep:5})):$(".pizza-floors-block",floorFancy).slick({slidesToShow:4,infinite:!1,arrows:!1,responsive:[{breakpoint:500,settings:{slidesToShow:3}},{breakpoint:380,settings:{slidesToShow:2}}]})}}}),templateUFloors(),$(".choose-floor-button").on("click",(function(e){e.preventDefault(),$.fancybox.close()}))})),$("#pizza-sides-button").on("click",(function(e){e.preventDefault(),$.fancybox.open({src:"#u-pizza-sides-fancybox",type:"inline",touch:!1,opts:{afterShow:function(instance,current){let sideFancy=$(document.body).find("#u-pizza-sides-fancybox");window.matchMedia("(min-width: 768px)").matches?sideFancy.height()>window.innerHeight-100&&(sideFancy.css("border-width","0"),$(".pizza-floors-block",sideFancy).slimScroll({height:window.innerHeight-100,railVisible:!0,alwaysVisible:!0,size:"6px",color:"#FF0329",railColor:"#EAEAEA",railOpacity:1,wheelStep:5})):$(".pizza-floors-block",sideFancy).slick({slidesToShow:4,infinite:!1,arrows:!1,responsive:[{breakpoint:500,settings:{slidesToShow:3}},{breakpoint:380,settings:{slidesToShow:2}}]})}}}),templateUSides(),$(".choose-floor-button").on("click",(function(e){e.preventDefault(),$.fancybox.close()}))}));const calculate=()=>{let sum=parseFloat(initialPrice);if(dataComponents.pizza.price_inc&&$(".pizza-components-block").length){const inputBaseValue=JSON.parse(inputBase.val());let priceToExclude=0;Object.values(dataComponents.pizza.base).map(component=>{inputBaseValue.map(c=>{let key=Object.keys(c)[0];key!==component.id||c[key]||(priceToExclude+=parseFloat(component.price))})}),sum-=priceToExclude}$("#add-component .pizza-components-item").each((function(){let val=$(this).find(".component-qty").val(),componentId=$(this).find(".component-buttons").attr("data-food-item"),componentObject=Object.values(dataComponents.pizza.extra).find(component=>component.id===componentId);void 0!==componentObject&&(sum+=parseFloat(componentObject.price)*parseInt(val))})),console.log(sum),refreshPriceHtml(sum)},refreshPriceHtml=summ=>{let priceContainer;$(".product").find(".price").html(u_wc_price(summ))},calculateComponentsRemove=el=>{if(!el.find(".u-remove-component").length)return;let componentId=el.attr("data-component-id");const inputBaseValue=JSON.parse(inputBase.val());let modiFiedData=inputBaseValue.map(c=>{let key=Object.keys(c)[0];return c.hasOwnProperty(componentId)?{[key]:!c[componentId]}:c});inputBase.val(JSON.stringify(modiFiedData)),refreshClasses(modiFiedData),calculate()},refreshClasses=data=>{$("#remove-component .pizza-components-item").each((function(){$(this).removeClass("active")})),data.forEach(c=>{let key=Object.keys(c)[0];!c[key]&&$(`[data-component-id=${key}]`).closest(".pizza-components-item").addClass("active")})}}}(jQuery);